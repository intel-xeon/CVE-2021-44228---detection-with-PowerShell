$ResultsCSV = "Result.csv" #save the result #MANDATORY FIELD
if (Test-Path $ResultsCSV) 
{
  Remove-Item -Path $ResultsCSV -Force
}
$Directory = "C:\" #directory to scan for logs file #MANDATORY FIELD
$RX = "\bjndi:ldap:|\bjndi:rmi:|\bjndi:ldaps:|\bjndi:dns:|\bjndi:nis:|\bjndi:nds:|\bjndi:corba:|\bjndi:iiop:|\bjndi:http:]"
$TextFiles = Get-ChildItem $Directory -Include *.txt*,*.csv*,*.rtf*,*.eml*,*.msg*,*.dat*,*.ini*,*.mht* -Recurse
$file2 =  new-object System.IO.StreamWriter($ResultsCSV)
$file2.WriteLine('Line,Matches,File Path') 
foreach ($FileSearched in $TextFiles) {
#echo $FileSearched
$file = New-Object System.IO.StreamReader ($FileSearched)
$line_n=0
foreach($line in Get-Content $FileSearched) {
	$line_n=$line_n+1
	#echo $line
    foreach ($match in ([regex]$RX).Matches($line)) {   
		$file2.WriteLine("{0},{1},{2}",$line_n,$line, $FileSearched.fullname )  
	}
}

$file.close();  
}
$file2.close()
