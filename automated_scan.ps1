	$ResultsCSV = "C:\result.csv" #save the result #MANDATORY FIELD
    $Directory = "C:\path\to\log" #directory to scan for logs file #MANDATORY FIELD
    #$RX = Get-Content "C:\Users\Documents\Log4j super\regex.txt" #IGNORE ME
    $RX = "\bjndi:ldap:|\bjndi:rmi:|\bjndi:ldaps:|\bjndi:dns:|\bjndi:nis:|\bjndi:nds:|\bjndi:corba:|\bjndi:iiop:|\bjndi:http:]"
    $TextFiles = Get-ChildItem $Directory -Include *.txt*,*.csv*,*.rtf*,*.eml*,*.msg*,*.dat*,*.ini*,*.mht* -Recurse
     $file2 =  new-object System.IO.StreamWriter($ResultsCSV)
     $file2.WriteLine('Matches,File Path') 

    foreach ($FileSearched in $TextFiles) {
        $file = New-Object System.IO.StreamReader ($FileSearched)
        while ($text = $file.ReadLine()) {     
            foreach ($match in ([regex]$RX).Matches($text)) {   
                   $file2.WriteLine("{0},{1}",$text, $FileSearched.fullname )  
            }
        }
         $file.close();  
    }
    $file2.close()
	



